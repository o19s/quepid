# Override for visual parity comparison runs.
# Use with: COMPOSE_PROJECT_NAME=quepid-vp COMPOSE_FILE=docker-compose.yml:docker-compose.visual-parity.yml
#
# Gives visual parity its own containers, volumes, and ports so it never conflicts
# with the main quepid stack (no data loss, can run alongside main quepid).

# Use !override to replace (not append) ports so VP doesn't conflict with main quepid
services:
  app:
    container_name: quepid-vp-app
    command: foreman s -f Procfile.vp
    ports: !override
      - "3010:3000"

  mysql:
    container_name: quepid-vp-db
    ports: !override
      - "3307:3306"

  keycloak:
    container_name: quepid-vp-keycloak
    ports: !override
      - "9081:9080"

  ollama:
    container_name: quepid-vp-ollama
    ports: !override
      - "11431:11434"
    volumes:
      - ./volumes/ollama/vp-data:/tmp/data

  nginx:
    container_name: quepid-vp-nginx
    ports: !override
      - "8444:8443"
      - "8080:80"
    volumes:
      - ./nginx.vp.conf:/etc/nginx/nginx.conf:ro
      - ./.ssl/:/etc/nginx/certs
